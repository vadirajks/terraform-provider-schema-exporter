version: 0
block:
  attributes:
    allow_open:
      type: bool
      description: This field applies only for Traffic Director policies. It is must be set to false for external HTTPS load balancer policies. Determines if server allows plaintext connections. If set to true, server allows plain text connections. By default, it is set to false. This setting is not exclusive of other encryption modes. For example, if allowOpen and mtlsPolicy are set, server allows both plain text and mTLS connections. See documentation of other encryption modes to confirm compatibility. Consider using it if you wish to upgrade in place your deployment to TLS while having mixed TLS and non-TLS traffic reaching port :80.
      description_kind: plain
      optional: true
    create_time:
      type: string
      description: Time the ServerTlsPolicy was created in UTC.
      description_kind: plain
      computed: true
    description:
      type: string
      description: A free-text description of the resource. Max length 1024 characters.
      description_kind: plain
      optional: true
    effective_labels:
      type:
      - map
      - string
      description: All of labels (key/value pairs) present on the resource in GCP, including the labels configured through Terraform, other clients and services.
      description_kind: plain
      computed: true
    id:
      type: string
      description_kind: plain
      optional: true
      computed: true
    labels:
      type:
      - map
      - string
      description: 'Set of label tags associated with the ServerTlsPolicy resource. **Note**: This field is non-authoritative, and will only manage the labels present in your configuration. Please refer to the field ''effective_labels'' for all of the labels present on the resource.'
      description_kind: plain
      optional: true
    location:
      type: string
      description: The location of the server tls policy. The default value is 'global'.
      description_kind: plain
      optional: true
    name:
      type: string
      description: Name of the ServerTlsPolicy resource.
      description_kind: plain
      required: true
    project:
      type: string
      description_kind: plain
      optional: true
      computed: true
    terraform_labels:
      type:
      - map
      - string
      description: The combination of labels configured directly on the resource and default labels configured on the provider.
      description_kind: plain
      computed: true
    update_time:
      type: string
      description: Time the ServerTlsPolicy was updated in UTC.
      description_kind: plain
      computed: true
  block_types:
    mtls_policy:
      nesting_mode: list
      block:
        attributes:
          client_validation_mode:
            type: string
            description: 'When the client presents an invalid certificate or no certificate to the load balancer, the clientValidationMode specifies how the client connection is handled. Required if the policy is to be used with the external HTTPS load balancing. For Traffic Director it must be empty. Possible values: ["CLIENT_VALIDATION_MODE_UNSPECIFIED", "ALLOW_INVALID_OR_MISSING_CLIENT_CERT", "REJECT_INVALID"]'
            description_kind: plain
            optional: true
          client_validation_trust_config:
            type: string
            description: Reference to the TrustConfig from certificatemanager.googleapis.com namespace. If specified, the chain validation will be performed against certificates configured in the given TrustConfig. Allowed only if the policy is to be used with external HTTPS load balancers.
            description_kind: plain
            optional: true
        block_types:
          client_validation_ca:
            nesting_mode: list
            block:
              block_types:
                certificate_provider_instance:
                  nesting_mode: list
                  block:
                    attributes:
                      plugin_instance:
                        type: string
                        description: Plugin instance name, used to locate and load CertificateProvider instance configuration. Set to "google_cloud_private_spiffe" to use Certificate Authority Service certificate provider instance.
                        description_kind: plain
                        required: true
                    description: Optional if policy is to be used with Traffic Director. For external HTTPS load balancer must be empty. Defines a mechanism to provision server identity (public and private keys). Cannot be combined with allowOpen as a permissive mode that allows both plain text and TLS is not supported.
                    description_kind: plain
                  max_items: 1
                grpc_endpoint:
                  nesting_mode: list
                  block:
                    attributes:
                      target_uri:
                        type: string
                        description: The target URI of the gRPC endpoint. Only UDS path is supported, and should start with "unix:".
                        description_kind: plain
                        required: true
                    description: gRPC specific configuration to access the gRPC server to obtain the cert and private key.
                    description_kind: plain
                  max_items: 1
              description: Required if the policy is to be used with Traffic Director. For external HTTPS load balancers it must be empty. Defines the mechanism to obtain the Certificate Authority certificate to validate the client certificate.
              description_kind: plain
        description: This field is required if the policy is used with external HTTPS load balancers. This field can be empty for Traffic Director. Defines a mechanism to provision peer validation certificates for peer to peer authentication (Mutual TLS - mTLS). If not specified, client certificate will not be requested. The connection is treated as TLS and not mTLS. If allowOpen and mtlsPolicy are set, server allows both plain text and mTLS connections.
        description_kind: plain
      max_items: 1
    server_certificate:
      nesting_mode: list
      block:
        block_types:
          certificate_provider_instance:
            nesting_mode: list
            block:
              attributes:
                plugin_instance:
                  type: string
                  description: Plugin instance name, used to locate and load CertificateProvider instance configuration. Set to "google_cloud_private_spiffe" to use Certificate Authority Service certificate provider instance.
                  description_kind: plain
                  required: true
              description: Optional if policy is to be used with Traffic Director. For external HTTPS load balancer must be empty. Defines a mechanism to provision server identity (public and private keys). Cannot be combined with allowOpen as a permissive mode that allows both plain text and TLS is not supported.
              description_kind: plain
            max_items: 1
          grpc_endpoint:
            nesting_mode: list
            block:
              attributes:
                target_uri:
                  type: string
                  description: The target URI of the gRPC endpoint. Only UDS path is supported, and should start with "unix:".
                  description_kind: plain
                  required: true
              description: gRPC specific configuration to access the gRPC server to obtain the cert and private key.
              description_kind: plain
            max_items: 1
        description: Defines a mechanism to provision client identity (public and private keys) for peer to peer authentication. The presence of this dictates mTLS.
        description_kind: plain
      max_items: 1
    timeouts:
      nesting_mode: single
      block:
        attributes:
          create:
            type: string
            description_kind: plain
            optional: true
          delete:
            type: string
            description_kind: plain
            optional: true
          update:
            type: string
            description_kind: plain
            optional: true
        description_kind: plain
  description_kind: plain
