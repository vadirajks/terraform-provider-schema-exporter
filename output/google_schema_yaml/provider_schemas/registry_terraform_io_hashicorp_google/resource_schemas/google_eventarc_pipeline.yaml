version: 0
block:
  attributes:
    annotations:
      type:
      - map
      - string
      description: 'User-defined annotations. See https://google.aip.dev/128#annotations. **Note**: This field is non-authoritative, and will only manage the annotations present in your configuration. Please refer to the field ''effective_annotations'' for all of the annotations present on the resource.'
      description_kind: plain
      optional: true
    create_time:
      type: string
      description: 'The creation time. A timestamp in RFC3339 UTC "Zulu" format, with nanosecond resolution and up to nine fractional digits. Examples: "2014-10-02T15:01:23Z" and "2014-10-02T15:01:23.045123456Z".'
      description_kind: plain
      computed: true
    crypto_key_name:
      type: string
      description: Resource name of a KMS crypto key (managed by the user) used to encrypt/decrypt the event data. If not set, an internal Google-owned key will be used to encrypt messages. It must match the pattern "projects/{project}/locations/{location}/keyRings/{keyring}/cryptoKeys/{key}".
      description_kind: plain
      optional: true
    display_name:
      type: string
      description: Display name of resource.
      description_kind: plain
      optional: true
    effective_annotations:
      type:
      - map
      - string
      description: All of annotations (key/value pairs) present on the resource in GCP, including the annotations configured through Terraform, other clients and services.
      description_kind: plain
      computed: true
    effective_labels:
      type:
      - map
      - string
      description: All of labels (key/value pairs) present on the resource in GCP, including the labels configured through Terraform, other clients and services.
      description_kind: plain
      computed: true
    etag:
      type: string
      description: This checksum is computed by the server based on the value of other fields, and might be sent only on create requests to ensure that the client has an up-to-date value before proceeding.
      description_kind: plain
      computed: true
    id:
      type: string
      description_kind: plain
      optional: true
      computed: true
    labels:
      type:
      - map
      - string
      description: 'User labels attached to the Pipeline that can be used to group resources. An object containing a list of "key": value pairs. Example: { "name": "wrench", "mass": "1.3kg", "count": "3" }. **Note**: This field is non-authoritative, and will only manage the labels present in your configuration. Please refer to the field ''effective_labels'' for all of the labels present on the resource.'
      description_kind: plain
      optional: true
    location:
      type: string
      description: Resource ID segment making up resource 'name'. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
      description_kind: plain
      required: true
    name:
      type: string
      description: The resource name of the Pipeline. Must be unique within the location of the project and must be in 'projects/{project}/locations/{location}/pipelines/{pipeline}' format.
      description_kind: plain
      computed: true
    pipeline_id:
      type: string
      description: The user-provided ID to be assigned to the Pipeline. It should match the format '^[a-z]([a-z0-9-]{0,61}[a-z0-9])?$'.
      description_kind: plain
      required: true
    project:
      type: string
      description_kind: plain
      optional: true
      computed: true
    terraform_labels:
      type:
      - map
      - string
      description: The combination of labels configured directly on the resource and default labels configured on the provider.
      description_kind: plain
      computed: true
    uid:
      type: string
      description: Server-assigned unique identifier for the Pipeline. The value is a UUID4 string and guaranteed to remain unchanged until the resource is deleted.
      description_kind: plain
      computed: true
    update_time:
      type: string
      description: 'The last-modified time. A timestamp in RFC3339 UTC "Zulu" format, with nanosecond resolution and up to nine fractional digits. Examples: "2014-10-02T15:01:23Z" and "2014-10-02T15:01:23.045123456Z".'
      description_kind: plain
      computed: true
  block_types:
    destinations:
      nesting_mode: list
      block:
        attributes:
          message_bus:
            type: string
            description: 'The resource name of the Message Bus to which events should be published. The Message Bus resource should exist in the same project as the Pipeline. Format: ''projects/{project}/locations/{location}/messageBuses/{message_bus}'''
            description_kind: plain
            optional: true
          topic:
            type: string
            description: 'The resource name of the Pub/Sub topic to which events should be published. Format: ''projects/{project}/locations/{location}/topics/{topic}'''
            description_kind: plain
            optional: true
          workflow:
            type: string
            description: 'The resource name of the Workflow whose Executions are triggered by the events. The Workflow resource should be deployed in the same project as the Pipeline. Format: ''projects/{project}/locations/{location}/workflows/{workflow}'''
            description_kind: plain
            optional: true
        block_types:
          authentication_config:
            nesting_mode: list
            block:
              block_types:
                google_oidc:
                  nesting_mode: list
                  block:
                    attributes:
                      audience:
                        type: string
                        description: Audience to be used to generate the OIDC Token. The audience claim identifies the recipient that the JWT is intended for. If unspecified, the destination URI will be used.
                        description_kind: plain
                        optional: true
                      service_account:
                        type: string
                        description: Service account email used to generate the OIDC Token. The principal who calls this API must have iam.serviceAccounts.actAs permission in the service account. See https://cloud.google.com/iam/docs/understanding-service-accounts for more information. Eventarc service agents must have roles/roles/iam.serviceAccountTokenCreator role to allow the Pipeline to create OpenID tokens for authenticated requests.
                        description_kind: plain
                        required: true
                    description: Represents a config used to authenticate with a Google OIDC token using a GCP service account. Use this authentication method to invoke your Cloud Run and Cloud Functions destinations or HTTP endpoints that support Google OIDC.
                    description_kind: plain
                  max_items: 1
                oauth_token:
                  nesting_mode: list
                  block:
                    attributes:
                      scope:
                        type: string
                        description: OAuth scope to be used for generating OAuth access token. If not specified, "https://www.googleapis.com/auth/cloud-platform" will be used.
                        description_kind: plain
                        optional: true
                      service_account:
                        type: string
                        description: Service account email used to generate the [OAuth token](https://developers.google.com/identity/protocols/OAuth2). The principal who calls this API must have iam.serviceAccounts.actAs permission in the service account. See https://cloud.google.com/iam/docs/understanding-service-accounts for more information. Eventarc service agents must have roles/roles/iam.serviceAccountTokenCreator role to allow Pipeline to create OAuth2 tokens for authenticated requests.
                        description_kind: plain
                        required: true
                    description: Contains information needed for generating an [OAuth token](https://developers.google.com/identity/protocols/OAuth2). This type of authorization should generally only be used when calling Google APIs hosted on *.googleapis.com.
                    description_kind: plain
                  max_items: 1
              description: Represents a config used to authenticate message requests.
              description_kind: plain
            max_items: 1
          http_endpoint:
            nesting_mode: list
            block:
              attributes:
                message_binding_template:
                  type: string
                  description: 'The CEL expression used to modify how the destination-bound HTTP request is constructed. If a binding expression is not specified here, the message is treated as a CloudEvent and is mapped to the HTTP request according to the CloudEvent HTTP Protocol Binding Binary Content Mode (https://github.com/cloudevents/spec/blob/main/cloudevents/bindings/http-protocol-binding.md#31-binary-content-mode). In this representation, all fields except the ''data'' and ''datacontenttype'' field on the message are mapped to HTTP request headers with a prefix of ''ce-''. To construct the HTTP request payload and the value of the content-type HTTP header, the payload format is defined as follows: 1) Use the output_payload_format_type on the Pipeline.Destination if it is set, else: 2) Use the input_payload_format_type on the Pipeline if it is set, else: 3) Treat the payload as opaque binary data. The ''data'' field of the message is converted to the payload format or left as-is for case 3) and then attached as the payload of the HTTP request. The ''content-type'' header on the HTTP request is set to the payload format type or left empty for case 3). However, if a mediation has updated the ''datacontenttype'' field on the message so that it is not the same as the payload format type but it is still a prefix of the payload format type, then the ''content-type'' header on the HTTP request is set to this ''datacontenttype'' value. For example, if the ''datacontenttype'' is "application/json" and the payload format type is "application/json; charset=utf-8", then the ''content-type'' header on the HTTP request is set to "application/json; charset=utf-8". If a non-empty binding expression is specified then this expression is used to modify the default CloudEvent HTTP Protocol Binding Binary Content representation. The result of the CEL expression must be a map of key/value pairs which is used as follows: - If a map named ''headers'' exists on the result of the expression, then its key/value pairs are directly mapped to the HTTP request headers. The headers values are constructed from the corresponding value type''s canonical representation. If the ''headers'' field doesn''t exist then the resulting HTTP request will be the headers of the CloudEvent HTTP Binding Binary Content Mode representation of the final message. Note: If the specified binding expression, has updated the ''datacontenttype'' field on the message so that it is not the same as the payload format type but it is still a prefix of the payload format type, then the ''content-type'' header in the ''headers'' map is set to this ''datacontenttype'' value. - If a field named ''body'' exists on the result of the expression then its value is directly mapped to the body of the request. If the value of the ''body'' field is of type bytes or string then it is used for the HTTP request body as-is, with no conversion. If the body field is of any other type then it is converted to a JSON string. If the body field does not exist then the resulting payload of the HTTP request will be data value of the CloudEvent HTTP Binding Binary Content Mode representation of the final message as described earlier. - Any other fields in the resulting expression will be ignored. The CEL expression may access the incoming CloudEvent message in its definition, as follows: - The ''data'' field of the incoming CloudEvent message can be accessed using the ''message.data'' value. Subfields of ''message.data'' may also be accessed if an input_payload_format has been specified on the Pipeline. - Each attribute of the incoming CloudEvent message can be accessed using the ''message.'' value, where  is replaced with the name of the attribute. - Existing headers can be accessed in the CEL expression using the ''headers'' variable. The ''headers'' variable defines a map of key/value pairs corresponding to the HTTP headers of the CloudEvent HTTP Binding Binary Content Mode representation of the final message as described earlier. For example, the following CEL expression can be used to construct an HTTP request by adding an additional header to the HTTP headers of the CloudEvent HTTP Binding Binary Content Mode representation of the final message and by overwriting the body of the request: '''''' { "headers": headers.merge({"new-header-key": "new-header-value"}), "body": "new-body" } '''''' - The default binding for the message payload can be accessed using the ''body'' variable. It conatins a string representation of the message payload in the format specified by the ''output_payload_format'' field. If the ''input_payload_format'' field is not set, the ''body'' variable contains the same message payload bytes that were published. Additionally, the following CEL extension functions are provided for use in this CEL expression: - toBase64Url: map.toBase64Url() -> string - Converts a CelValue to a base64url encoded string - toJsonString: map.toJsonString() -> string - Converts a CelValue to a JSON string - merge: map1.merge(map2) -> map3 - Merges the passed CEL map with the existing CEL map the function is applied to. - If the same key exists in both maps, if the key''s value is type map both maps are merged else the value from the passed map is used. - denormalize: map.denormalize() -> map - Denormalizes a CEL map such that every value of type map or key in the map is expanded to return a single level map. - The resulting keys are "." separated indices of the map keys. - For example: { "a": 1, "b": { "c": 2, "d": 3 } "e": [4, 5] } .denormalize() -> { "a": 1, "b.c": 2, "b.d": 3, "e.0": 4, "e.1": 5 } - setField: map.setField(key, value) -> message - Sets the field of the message with the given key to the given value. - If the field is not present it will be added. - If the field is present it will be overwritten. - The key can be a dot separated path to set a field in a nested message. - Key must be of type string. - Value may be any valid type. - removeFields: map.removeFields([key1, key2, ...]) -> message - Removes the fields of the map with the given keys. - The keys can be a dot separated path to remove a field in a nested message. - If a key is not found it will be ignored. - Keys must be of type string. - toMap: [map1, map2, ...].toMap() -> map - Converts a CEL list of CEL maps to a single CEL map - toCloudEventJsonWithPayloadFormat: message.toCloudEventJsonWithPayloadFormat() -> map - Converts a message to the corresponding structure of JSON format for CloudEvents. - It converts ''data'' to destination payload format specified in ''output_payload_format''. If ''output_payload_format'' is not set, the data will remain unchanged. - It also sets the corresponding datacontenttype of the CloudEvent, as indicated by ''output_payload_format''. If no ''output_payload_format'' is set it will use the value of the "datacontenttype" attribute on the CloudEvent if present, else remove "datacontenttype" attribute. - This function expects that the content of the message will adhere to the standard CloudEvent format. If it doesn''t then this function will fail. - The result is a CEL map that corresponds to the JSON representation of the CloudEvent. To convert that data to a JSON string it can be chained with the toJsonString function. The Pipeline expects that the message it receives adheres to the standard CloudEvent format. If it doesn''t then the outgoing message request may fail with a persistent error.'
                  description_kind: plain
                  optional: true
                uri:
                  type: string
                  description: 'The URI of the HTTP enpdoint. The value must be a RFC2396 URI string. Examples: ''https://svc.us-central1.p.local:8080/route''. Only the HTTPS protocol is supported.'
                  description_kind: plain
                  required: true
              description: Represents a HTTP endpoint destination.
              description_kind: plain
            max_items: 1
          network_config:
            nesting_mode: list
            block:
              attributes:
                network_attachment:
                  type: string
                  description: 'Name of the NetworkAttachment that allows access to the consumer VPC. Format: ''projects/{PROJECT_ID}/regions/{REGION}/networkAttachments/{NETWORK_ATTACHMENT_NAME}'' Required for HTTP endpoint destinations. Must not be specified for Workflows, MessageBus, or Topic destinations.'
                  description_kind: plain
                  optional: true
              description: Represents a network config to be used for destination resolution and connectivity.
              description_kind: plain
            max_items: 1
          output_payload_format:
            nesting_mode: list
            block:
              block_types:
                avro:
                  nesting_mode: list
                  block:
                    attributes:
                      schema_definition:
                        type: string
                        description: The entire schema definition is stored in this field.
                        description_kind: plain
                        optional: true
                    description: The format of an AVRO message payload.
                    description_kind: plain
                  max_items: 1
                json:
                  nesting_mode: list
                  block:
                    description: The format of a JSON message payload.
                    description_kind: plain
                  max_items: 1
                protobuf:
                  nesting_mode: list
                  block:
                    attributes:
                      schema_definition:
                        type: string
                        description: The entire schema definition is stored in this field.
                        description_kind: plain
                        optional: true
                    description: The format of a Protobuf message payload.
                    description_kind: plain
                  max_items: 1
              description: Represents the format of message data.
              description_kind: plain
            max_items: 1
        description: List of destinations to which messages will be forwarded. Currently, exactly one destination is supported per Pipeline.
        description_kind: plain
      min_items: 1
    input_payload_format:
      nesting_mode: list
      block:
        block_types:
          avro:
            nesting_mode: list
            block:
              attributes:
                schema_definition:
                  type: string
                  description: The entire schema definition is stored in this field.
                  description_kind: plain
                  optional: true
              description: The format of an AVRO message payload.
              description_kind: plain
            max_items: 1
          json:
            nesting_mode: list
            block:
              description: The format of a JSON message payload.
              description_kind: plain
            max_items: 1
          protobuf:
            nesting_mode: list
            block:
              attributes:
                schema_definition:
                  type: string
                  description: The entire schema definition is stored in this field.
                  description_kind: plain
                  optional: true
              description: The format of a Protobuf message payload.
              description_kind: plain
            max_items: 1
        description: Represents the format of message data.
        description_kind: plain
      max_items: 1
    logging_config:
      nesting_mode: list
      block:
        attributes:
          log_severity:
            type: string
            description: "The minimum severity of logs that will be sent to Stackdriver/Platform Telemetry. Logs at severitiy \u2265 this value will be sent, unless it is NONE. Possible values: [\"NONE\", \"DEBUG\", \"INFO\", \"NOTICE\", \"WARNING\", \"ERROR\", \"CRITICAL\", \"ALERT\", \"EMERGENCY\"]"
            description_kind: plain
            optional: true
            computed: true
        description: The configuration for Platform Telemetry logging for Eventarc Advanced resources.
        description_kind: plain
      max_items: 1
    mediations:
      nesting_mode: list
      block:
        block_types:
          transformation:
            nesting_mode: list
            block:
              attributes:
                transformation_template:
                  type: string
                  description: 'The CEL expression template to apply to transform messages. The following CEL extension functions are provided for use in this CEL expression: - merge: map1.merge(map2) -> map3 - Merges the passed CEL map with the existing CEL map the function is applied to. - If the same key exists in both maps, if the key''s value is type map both maps are merged else the value from the passed map is used. - denormalize: map.denormalize() -> map - Denormalizes a CEL map such that every value of type map or key in the map is expanded to return a single level map. - The resulting keys are "." separated indices of the map keys. - For example: { "a": 1, "b": { "c": 2, "d": 3 } "e": [4, 5] } .denormalize() -> { "a": 1, "b.c": 2, "b.d": 3, "e.0": 4, "e.1": 5 } - setField: map.setField(key, value) -> message - Sets the field of the message with the given key to the given value. - If the field is not present it will be added. - If the field is present it will be overwritten. - The key can be a dot separated path to set a field in a nested message. - Key must be of type string. - Value may be any valid type. - removeFields: map.removeFields([key1, key2, ...]) -> message - Removes the fields of the map with the given keys. - The keys can be a dot separated path to remove a field in a nested message. - If a key is not found it will be ignored. - Keys must be of type string. - toMap: [map1, map2, ...].toMap() -> map - Converts a CEL list of CEL maps to a single CEL map - toDestinationPayloadFormat(): message.data.toDestinationPayloadFormat() -> string or bytes - Converts the message data to the destination payload format specified in Pipeline.Destination.output_payload_format - This function is meant to be applied to the message.data field. - If the destination payload format is not set, the function will return the message data unchanged. - toCloudEventJsonWithPayloadFormat: message.toCloudEventJsonWithPayloadFormat() -> map - Converts a message to the corresponding structure of JSON format for CloudEvents - This function applies toDestinationPayloadFormat() to the message data. It also sets the corresponding datacontenttype of the CloudEvent, as indicated by Pipeline.Destination.output_payload_format. If no output_payload_format is set it will use the existing datacontenttype on the CloudEvent if present, else leave datacontenttype absent. - This function expects that the content of the message will adhere to the standard CloudEvent format. If it doesn''t then this function will fail. - The result is a CEL map that corresponds to the JSON representation of the CloudEvent. To convert that data to a JSON string it can be chained with the toJsonString function.'
                  description_kind: plain
                  optional: true
              description: Transformation defines the way to transform an incoming message.
              description_kind: plain
            max_items: 1
        description: List of mediation operations to be performed on the message. Currently, only one Transformation operation is allowed in each Pipeline.
        description_kind: plain
    retry_policy:
      nesting_mode: list
      block:
        attributes:
          max_attempts:
            type: number
            description: The maximum number of delivery attempts for any message. The value must be between 1 and 100. The default value for this field is 5.
            description_kind: plain
            optional: true
          max_retry_delay:
            type: string
            description: The maximum amount of seconds to wait between retry attempts. The value must be between 1 and 600. The default value for this field is 60.
            description_kind: plain
            optional: true
          min_retry_delay:
            type: string
            description: The minimum amount of seconds to wait between retry attempts. The value must be between 1 and 600. The default value for this field is 5.
            description_kind: plain
            optional: true
        description: 'The retry policy configuration for the Pipeline. The pipeline exponentially backs off in case the destination is non responsive or returns a retryable error code. The default semantics are as follows: The backoff starts with a 5 second delay and doubles the delay after each failed attempt (10 seconds, 20 seconds, 40 seconds, etc.). The delay is capped at 60 seconds by default. Please note that if you set the min_retry_delay and max_retry_delay fields to the same value this will make the duration between retries constant.'
        description_kind: plain
      max_items: 1
    timeouts:
      nesting_mode: single
      block:
        attributes:
          create:
            type: string
            description_kind: plain
            optional: true
          delete:
            type: string
            description_kind: plain
            optional: true
          update:
            type: string
            description_kind: plain
            optional: true
        description_kind: plain
  description_kind: plain
