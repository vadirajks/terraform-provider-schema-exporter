version: 0
block:
  attributes:
    create_time:
      type: string
      description: The time when the repository was created.
      description_kind: plain
      computed: true
    id:
      type: string
      description_kind: plain
      optional: true
      computed: true
    kind:
      type: string
      description: The note kind which explicitly denotes which of the occurrence details are specified. This field can be used as a filter in list requests.
      description_kind: plain
      computed: true
    name:
      type: string
      description: The name of the occurrence.
      description_kind: plain
      computed: true
    note_name:
      type: string
      description: The analysis note associated with this occurrence, in the form of projects/[PROJECT]/notes/[NOTE_ID]. This field can be used as a filter in list requests.
      description_kind: plain
      required: true
    project:
      type: string
      description_kind: plain
      optional: true
      computed: true
    remediation:
      type: string
      description: A description of actions that can be taken to remedy the note.
      description_kind: plain
      optional: true
    resource_uri:
      type: string
      description: Required. Immutable. A URI that represents the resource for which the occurrence applies. For example, https://gcr.io/project/image@sha256:123abc for a Docker image.
      description_kind: plain
      required: true
    update_time:
      type: string
      description: The time when the repository was last updated.
      description_kind: plain
      computed: true
  block_types:
    attestation:
      nesting_mode: list
      block:
        attributes:
          serialized_payload:
            type: string
            description: The serialized payload that is verified by one or more signatures. A base64-encoded string.
            description_kind: plain
            required: true
        block_types:
          signatures:
            nesting_mode: set
            block:
              attributes:
                public_key_id:
                  type: string
                  description: 'The identifier for the public key that verifies this signature. MUST be an RFC3986 conformant URI. * When possible, the key id should be an immutable reference, such as a cryptographic digest. Examples of valid values: * OpenPGP V4 public key fingerprint. See https://www.iana.org/assignments/uri-schemes/prov/openpgp4fpr for more details on this scheme. * ''openpgp4fpr:74FAF3B861BDA0870C7B6DEF607E48D2A663AEEA'' * RFC6920 digest-named SubjectPublicKeyInfo (digest of the DER serialization): * "ni:///sha-256;cD9o9Cq6LG3jD0iKXqEi_vdjJGecm_iXkbqVoScViaU"'
                  description_kind: plain
                  required: true
                signature:
                  type: string
                  description: The content of the signature, an opaque bytestring. The payload that this signature verifies MUST be unambiguously provided with the Signature during verification. A wrapper message might provide the payload explicitly. Alternatively, a message might have a canonical serialization that can always be unambiguously computed to derive the payload.
                  description_kind: plain
                  optional: true
              description: One or more signatures over serializedPayload. Verifier implementations should consider this attestation message verified if at least one signature verifies serializedPayload. See Signature in common.proto for more details on signature structure and verification.
              description_kind: plain
            min_items: 1
        description: Occurrence that represents a single "attestation". The authenticity of an attestation can be verified using the attached signature. If the verifier trusts the public key of the signer, then verifying the signature is sufficient to establish trust. In this circumstance, the authority to which this attestation is attached is primarily useful for lookup (how to find this attestation if you already know the authority and artifact to be verified) and intent (for which authority this attestation was intended to sign.
        description_kind: plain
      min_items: 1
      max_items: 1
    timeouts:
      nesting_mode: single
      block:
        attributes:
          create:
            type: string
            description_kind: plain
            optional: true
          delete:
            type: string
            description_kind: plain
            optional: true
          update:
            type: string
            description_kind: plain
            optional: true
        description_kind: plain
  description_kind: plain
